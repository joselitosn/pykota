# $Id$

PyKota - Print Quota for CUPS and LPRng

(c) 2003-2004 Jerome Alet <alet@librelogiciel.com>
This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.

====================================================================

  These recommandations are there because as of April 28th 2003 
  PyKota doesn't enforce them. You may or may not follow them,
  depending on your user's IT knowledge, how much your trust them,
  etc...
  
====================================================================

How to improve PyKota's security :
----------------------------------

  - Most of the stuff which was there was deleted because PyKota's
    configuration files permissions should take care of most
    security problems. BUT of course, you have to set them correctly !
    
  - Secure your printer :  
  
    Tell it to refuse any print job not coming from your print
    server.
    
    Don't give shell access to your users on your print server,
    or don't let them execute unauthorized commands : they could
    very well compile and execute tools like NetCat, and send 
    datas directly to the printer in the case the printer is
    networked, thus bypassing the printing system and PyKota.
    
  - Ensure that no regular user can read PyKota administrator's 
    configuration file, but that both the print quota administrator and 
    the user the printing system is run as can read it. Depending on 
    your system's configuration, this may give something like : 
    
      $ chown lp.lpadmin /etc/pykota/pykotadmin.conf
      $ chmod 640 /etc/pykota/pykotadmin.conf
    
    If the print quota administrator is root then he will always be
    able to read PyKota's configuration file.
    
    Letting any user read PyKota administrator's configuration file may 
    expose passwords or database information which would allow write
    access to the database, and so may transform your print quota
    management in a nightmare.
  
    If you want to let users generate their own print quota reports, 
    then ensure that /etc/pykota/pykota.conf is readable by
    everyone, but writeable only by the root user :
    
      $ chown root.root /etc/pykota/pykota.conf
      $ chmod 644 /etc/pykota/pykota.conf
      
    NB : If you use the printquota.cgi CGI script, ensure that
         the user this script is run as (e.g. nobody or www-data)
         can read PyKota's configuration file /etc/pykota/pykota.conf
         BUT can't read PyKota administrator's configuration file
         /etc/pykota/pykotadmin.conf
         Refer to Apache's documentation for details.
  
  - Secure your database connection :
  
    Depending on the database backend used, either PostgreSQL or
    OpenLDAP, you may have to take additionnal measures to render
    your database more secure. Please refer to your database system's
    documentation on configuration to learn how to do so. This is out
    of the scope of the present document which will only give basic
    informations.
    
    Keep in mind that if you use a centralized database, you may have
    to restrict which hosts can access to it (i.e. the Print Servers).
    
    For the PostgreSQL backend, PyKota already defines a user with 
    read/write access and another user with read-only access to
    the Print Quota Database. PyKota doesn't set any passwords
    for these users though, but doing it is recommanded, and 
    explained elsewhere in PyKota's documentation.
    
    For the OpenLDAP backend, YOU have to ensure that no regular
    user can write to any PyKota specific attribute or objectClass.
    Otherwise they could modify their quota at will.
    
    You also have to define two binding DNs in your LDAP tree,
    one of them should be able to have a read only access to
    everything. The other one should be able to write, for 
    example your LDAP admin user is fine for this.
    Now put the readonly user in /etc/pykota/pykota.conf
    and the read-write one in /etc/pykota/pykotadmin.conf
    
====================================================================
